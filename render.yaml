databases:
  # This section defines the managed PostgreSQL database
  - name: healthcheckr-db
    plan: free

services:
  # The Flask web app, using your image from Docker Hub
  - type: web
    name: healthcheckr-webapp
    plan: free
    env: docker
    image:
      url: docker.io/silentlover/healthcheckr-webapp:latest
    envVars:
      - key: DATABASE_URL
        fromService:
          type: postgres # This must be 'postgres'
          name: healthcheckr-db
          property: connectionString

  # The Python background checker, also using an image from Docker Hub
  - type: worker
    name: healthcheckr-checker
    plan: free
    env: docker
    image:
      url: docker.io/silentlover/healthcheckr-checker:latest
    envVars:
      - key: DATABASE_URL
        fromService:
          type: postgres # This must be 'postgres'
          name: healthcheckr-db
          property: connectionString
      # Add your SMTP credentials for email alerts
      - key: SMTP_SERVER
        value: smtp.gmail.com
      - key: SMTP_PORT
        value: 587
      - key: SENDER_EMAIL
        value: your-email@gmail.com
      - key: SMTP_PASSWORD
        value: your-new-app-password